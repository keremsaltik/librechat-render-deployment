services:
  # 1. Ana Uygulama (LibreChat)
  - type: web
    name: librechat
    env: docker
    image:
      url: docker.io/keremle/librechat:v0.8.1 # Kendi Docker Hub adın
    healthCheckPath: /
    envVars:
      - key: HOST
        value: 0.0.0.0
      - key: PORT
        value: 3080
      # --- DÜZELTİLMİŞ KISIM ---
      - key: MONGO_URI
        value: mongodb://${mongodb.host}:${mongodb.port}/LibreChat
      - key: RAG_API_URL
        value: http://${rag-api.host}:${rag-api.port}
      - key: MEILI_HOST
        value: http://${meilisearch.host}:${meilisearch.port}
      # --- GİZLİ BİLGİLER (Bunlar doğruydu, kalıyor) ---
      - key: OPENAI_API_KEY
        sync: false
      - key: GOOGLE_SEARCH_API_KEY
        sync: false
      - key: GOOGLE_CSE_ID
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: JWT_REFRESH_SECRET
        sync: false
      - key: MEILI_MASTER_KEY
        sync: false
      - key: RAG_API_KEY
        sync: false
      - key: RAG_OPENAI_API_KEY
        sync: false
      # ... .env dosyasındaki diğer tüm anahtarlar buraya "sync: false" ile eklenecek

  # 2. MongoDB Veritabanı
  - type: pserv
    name: mongodb
    env: docker
    image:
      url: docker.io/keremle/mongo-librechat:latest # Kendi Docker Hub adın

  # 3. RAG API
  - type: pserv
    name: rag-api
    env: docker
    image:
      url: docker.io/keremle/librechat-rag-api:latest # Kendi Docker Hub adın
    envVars:
      - key: DB_HOST
        fromService:
          type: pserv
          name: vectordb
          property: host
      # ... RAG'ın diğer .env ayarları buraya gelecek

  # 4. MeiliSearch
  - type: pserv
    name: meilisearch
    env: docker
    image:
      url: docker.io/keremle/meilisearch-librechat:v1.12.3 # Kendi Docker Hub adın

  # 5. VectorDB
  - type: pserv
    name: vectordb
    env: docker
    image:
      url: docker.io/keremle/pgvector-librechat:latest # Kendi Docker Hub adın
    envVars:
      - key: POSTGRES_USER
        value: user
      - key: POSTGRES_PASSWORD
        generateValue: true # Render şifreyi kendi oluştursun
      - key: POSTGRES_DB
        value: vectordb